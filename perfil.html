<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DoeApp | Perfil</title>
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/body.css">
    <link rel="stylesheet" href="css/carousel.css">
    <link rel="stylesheet" href="css/perfil.css">
</head>

<body>
    <header>
        <div class="logo">
            <a href="index.html"><img src="img/logo.png" alt="Logo do site"></a>
        </div>
        <div class="hamburger" id="hamburger">
            &#9776;
        </div>
        <nav id="nav-links">
            <div class="dropdown-menu" id="dropdownMenu">
                <a href="perfil.html">VER PERFIL</a>
                <button id="logoutButton">Deslogar</button>
            </div>
            <a href="explorar.html">EXPLORAR</a>
            <a href="sobre.html">SOBRE NÓS</a>
            <a id="contatoButton">✉</a>
            <a href="login.html" class="btn-entrar">ENTRAR</a>
            <a href="cadastro.html" class="btn-cadastrar">CADASTRAR-SE</a>
            <a class="btn-perfil">NOME</a>
        </nav>

        <!-- Escurece o fundo | menu hamburguer -->
        <div class="overlay" id="overlay"></div>
        <script src="js/menu.js"></script>
    </header>

    <div id="contactModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-left">
                <h2>Envie-nos uma mensagem</h2>
                <form id="contactForm">
                    <label for="nome">Nome:</label>
                    <input type="text" id="nome" required>

                    <label for="email">Email:</label>
                    <input type="email" id="email" required>

                    <label for="telefone">Telefone:</label>
                    <input type="text" id="telefone" placeholder="(XX) XXXXX-XXXX" required>

                    <label for="assunto">Assunto:</label>
                    <input type="text" id="assunto" required>

                    <label for="mensagem">Mensagem:</label>
                    <textarea id="mensagem" rows="5" required></textarea>

                    <!-- Captcha Placeholder -->
                    <div class="captcha">
                        <p>Por favor, resolva o captcha antes de enviar.</p>
                    </div>

                    <button type="submit">Enviar</button>
                </form>
            </div>
            <div class="modal-right">
                <h3>Nossas informações:</h3>
                <p><span>Endereços:</span> <br> Rua Exemplo, 123 <br> Avenida Modelo, 456 <br> Travessa Teste, 789</p>
                <p><span>Telefone:</span> <br> (11) 1234-5678</p>
                <p><span>Email:</span> <br> contato@exemplo.com</p>
            </div>
        </div>
    </div>
    <script src="js/modal.js"></script>

    <div class="main-container">
        <div class="profile-section">
            <div class="profile-background"></div>
            <img src="img/default-profile-picture.png" alt="Imagem de Perfil" class="profile-pic" id="profile-photo">
            <div>
                <h1 class="username" id="username">Nome</h1>
                <p class="username-description" id="profile-description">Breve descrição da pessoa ou organização.</p>
                <button class="edit-button" onclick="toggleEditMenu()">Editar Perfil</button>
                <a href="------">
                    <button id="criarCampanha" class="create-campaign-btn" style="display: none;">Criar
                        Campanha</button>
                </a>
            </div>
        </div>

        <div class="sections">
            <div class="section">
                <h3>Últimas Doações</h3>
                <div class="campaign-list">
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 2">
                        <h4>Título Campanha 2</h4>
                        <p>Descrição da Campanha 2</p>
                    </div>
                </div>
            </div>
            <div class="section">
                <h3>Seus Favoritos</h3>
                <div class="campaign-list">
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 1">
                        <h4>Título Campanha 1</h4>
                        <p>Descrição da Campanha 1</p>
                    </div>
                    <div class="campaign-item">
                        <img src="img/placeholder.png" alt="Campanha 2">
                        <h4>Título Campanha 2</h4>
                        <p>Descrição da Campanha 2</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Alteração do menu de edição -->
    <div class="edit-menu" id="edit-menu">
        <div class="edit-menu-header">
            <h2>Editar Perfil</h2>
            <button class="close-button" onclick="toggleEditMenu()">×</button>
        </div>
        <label for="name-input">Alterar Nome</label>
        <input type="text" id="name-input" placeholder="Novo nome">
        <label for="description-input">Alterar Descrição</label>
        <input type="text" id="description-input" placeholder="Nova descrição">
        <label for="photo-input">Selecionar Foto de Perfil</label>
        <input type="file" id="photo-input" accept="image/*">
        <label for="background-input">Selecionar Foto de Fundo</label>
        <input type="file" id="background-input" accept="image/*">
        <button onclick="saveChanges()">Salvar Alterações</button>
    </div>

    <div class="overlay" id="overlay"></div>

    <script>
        function toggleEditMenu() {
            const menu = document.getElementById('edit-menu');
            const overlay = document.getElementById('overlay');
            menu.classList.toggle('visible');
            overlay.classList.toggle('visible');
        }

        // Função para salvar as alterações feitas no menu de edição
        function saveChanges() {
            // Pega os valores dos campos de entrada
            const nameInput = document.getElementById('name-input');
            const descriptionInput = document.getElementById('description-input');
            const photoInput = document.getElementById('photo-input');
            const backgroundInput = document.getElementById('background-input');

            // Atualiza o nome
            if (nameInput.value.trim() !== "") {
                document.getElementById('username').textContent = nameInput.value;
                localStorage.setItem("nome", nameInput.value); // Salva no localStorage
            }

            // Atualiza a descrição
            if (descriptionInput.value.trim() !== "") {
                document.getElementById('profile-description').textContent = descriptionInput.value;
                localStorage.setItem("descricao", descriptionInput.value); // Salva no localStorage
            }

            // Atualiza a foto de perfil
            if (photoInput.files && photoInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('profile-photo').src = e.target.result;
                    localStorage.setItem("fotoPerfil", e.target.result); // Salva no localStorage
                };
                reader.readAsDataURL(photoInput.files[0]);
            }

            // Atualiza a foto de fundo
            if (backgroundInput.files && backgroundInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.querySelector('.profile-background').style.backgroundImage = `url(${e.target.result})`;
                    localStorage.setItem("fotoFundo", e.target.result); // Salva no localStorage
                };
                reader.readAsDataURL(backgroundInput.files[0]);
            }

            // Fecha o menu de edição
            toggleEditMenu();
        }

        // Carrega dados salvos do localStorage ao abrir a página
        document.addEventListener("DOMContentLoaded", function () {
            const nome = localStorage.getItem("nome");
            const descricao = localStorage.getItem("descricao");
            const fotoPerfil = localStorage.getItem("fotoPerfil");
            const fotoFundo = localStorage.getItem("fotoFundo");

            if (nome) document.getElementById('username').textContent = nome;
            if (descricao) document.getElementById('profile-description').textContent = descricao;
            if (fotoPerfil) document.getElementById('profile-photo').src = fotoPerfil;
            if (fotoFundo) document.querySelector('.profile-background').style.backgroundImage = `url(${fotoFundo})`;
        });

        document.addEventListener("DOMContentLoaded", function () {
            const tipoConta = localStorage.getItem("tipoConta");
            console.log(`Tipo de conta recuperado: ${tipoConta}`); 
            const criarCampanhaBtn = document.getElementById("criarCampanha");

            if (criarCampanhaBtn) {
                if (tipoConta === "juridica") {
                    criarCampanhaBtn.style.display = "block";
                } else {
                    criarCampanhaBtn.style.display = "none";
                }
            } else {
                console.error("Elemento criarCampanha não encontrado no DOM.");
            }
        });

    </script>
</body>

</html>